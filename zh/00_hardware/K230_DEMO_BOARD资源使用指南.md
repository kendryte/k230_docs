# K230 DEMO BOARD 资源使用说明

![cover](images/HDG/canaan-cover.png)

<div style="page-break-after:always"></div>

## 免责声明

您购买的产品、服务或特性等应受北京嘉楠捷思信息技术有限公司（“本公司”，下同）及其关联公司的商业合同和条款的约束，本文档中描述的全部或部分产品、服务或特性可能不在您的购买或使用范围之内。除非合同另有约定，本公司不对本文档的任何陈述、信息、内容的正确性、可靠性、完整性、适销性、符合特定目的和不侵权提供任何明示或默示的声明或保证。除非另有约定，本文档仅作为使用指导参考。

由于产品版本升级或其他原因，本文档内容将可能在未经任何通知的情况下，不定期进行更新或修改。

## 商标声明

![logo](./images/K230_DEMO_BOARD_USAGE_GUIDE/image3.png)、“嘉楠”和其他嘉楠商标均为北京嘉楠捷思信息技术有限公司及其关联公司的商标。本文档可能提及的其他所有商标或注册商标，由各自的所有人拥有。

**版权所有 © 2023北京嘉楠捷思信息技术有限公司。保留一切权利。**
非经本公司书面许可，任何单位和个人不得擅自摘抄、复制本文档内容的部分或全部，并不得以任何形式传播。

<div style="page-break-after:always"></div>

## 目录

[TOC]

## 前言

### 概述

本文档主要介绍了K230 DEMO BOARD的使用说明。

### 读者对象

本文档（本指南）主要适用于以下人员：

- 技术支持工程师
- 软件开发工程师

### 缩略词定义

| 简称 | 说明 |
|------|------|
|      |      |
|      |      |

### 修订记录

| 文档版本号 | 修改说明                        | 修改者 | 日期       |
|------------|---------------------------------|--------|------------|
| V1.0       | 初版                            | 杜瓴一 | 2023-03-10 |
| V1.1       | 改为对应EVB V1.1的说明          | 杜瓴一 | 2023-05-05 |
| V1.2       | 更新了J5，USB OTG的排针使用方法 | 杜瓴一 | 2023-05-10 |
| V1.3       | 将内容从EVB更改为K230 DEMO BOARD|杜瓴一|2023-06-07|

## 开发板概述

### K230 DEMO BOARD概要

K230 DEMO BOARD是加装了摄像头子板和屏幕的完整开发测试板，已处于Plug-and-play状态，上电即可开始进行针对K230的后续开发工作。K230 DEMO BOARD会以一主板组装多子板的形式交付。本文档将通过主板上的各个接口，简要概述K230 DEMO BOARD各项配套的组件子板以及使用流程。

### K230 DEMO BOARD主板示意图

![K230 DEMO BOARD 样例](./images/K230_DEMO_BOARD_USAGE_GUIDE/image4.png)
（**图1.2.1**：K230 DEMO BOARD样品示例，子板未组装）

### K230 DEMO BOARD配套组装子板

为确保验证灵活性，K230 DEMO BOARD配有多种接口，具备与不同种类的子卡连通的能力从而更为全面的开发芯片功能。主板所能搭载的子板种类如下：

- Flash模组子卡（使用详情参阅**章节2.2**）

- DSI屏幕与转接板（使用详情参阅**章节2.4**）

- IMX335模组Sensor板（使用详情参阅**章节2.4**）

- WIFI子卡（使用详情参阅**章节2.6**）

- I2S/PDM接口数字音频子卡（使用详情参阅**章节2.7**）

接口与子卡的使用方式将在**章节2**中介绍该子卡对应的接口时进行详细说明。以上子卡中，Flash模组子卡，DSI屏幕与转接板，IMX335模组Sensor板将被组装在K230 DEMO BOARD主板上交付，其余子卡默认**不包含**在K230 DEMO BOARD的交付清单中，在此列出仅用于辅助说明相关的接口功能及用法。

此外，以下使用K230 DEMO BOARD交付时会包含以下开发用线缆：

- USB Type C 线缆2根

- OTG转接线，Type C公头转USB-A母头1根

- Type C公头转网口线缆1根

组装完整的DEMO板请参考**图1.3.1**。

![K230 DEMO BOARD样品示例，完整组装](./images/K230_DEMO_BOARD_USAGE_GUIDE/image5.png)
（**图1.3.1**：K230 DEMO BOARD样品示例，完整组装）

## DEMO BOARD硬件功能说明

### K230 DEMO BOARD主板功能模块与全部接口

![K230 DEMO BOARD功能区域划分](./images/K230_DEMO_BOARD_USAGE_GUIDE/image6.png)
![所支持的所有接口与其在DEMO BOARD上对应的位置](./images/K230_DEMO_BOARD_USAGE_GUIDE/image7.png)
（**图2.1.1**：上图为K230 DEMO BOARD功能区域划分，下图为所支持的所有接口与其在DEMO BOARD上对应的位置）

K230 DEMO BOARD可以按照**图2.1.1**中左图所示大致划分为6个区域，按所标序号顺序依次为：

1. （蓝色）核心区 -即主芯片K230及其存储DDR，flash，eMMC，以及系统主时钟的所在位置。

1. （红色）电源区 - 即DEMO BOARD主板上全部电源，电源控制器件的所在位置。

1. （绿色）视频输入输出 - 即摄像头与屏幕与主板连接的位置。

1. （橙色）音频输入输出 - 即麦克风与耳机的所在位置。

1. （紫色）通用接口 -- 与其他设备进行数据交换的接口区域。

1. （黄色）排针接口 -- 此区域包含DEMO BOARD上关键信号的对应排针，可以被作为测试点或者与外接信号，扩展子卡等连接点。

左图中的每个区域包含数个右图中所列出的器件/接口。在本章节接下来的部分中，会按照上述顺序依次陈列每个区域中所覆盖的器件/接口。如有需要，会在陈列对应器件/接口时进行额外的信息补充或者使用方法说明。

**在本章节出现了原理图的场合中，如无特殊说明，则默认DEMO BOARD上器件封装的引脚与原理图上的封装引脚完全一致（指单双排，引脚出线顺序）。另外提到的所有引脚编号，器件编号均在K230 DEMO BOARD上通过白字丝印留有注明，请结合DEMO BOARD实物确认。**

### 核心区（基本参数）

本部分为DEMO BOARD的核心处理与存储区，包含**图2.1.1**右图中所罗列的如下5个接口/器件：

1. **K230-USIP（DEMO BOARD上器件编号：U1）**

1. **LPDDR3（DEMO BOARD上器件编号：U5）**
选型为NT6CL128M32DM-H0，南亚32bits - 4Gbits的LPDDR3，上限速率为2133Mbps

1. **eMMC（DEMO BOARD上器件编号：U30）**
选型为KLM4G1FETE-B041，三星8bits - 4GBytes的eMMC，兼容至Ver.
5.1，时钟速率200MHz

1. **Flash扩展（DEMO BOARD上器件编号：J9）**

![flash模组子卡的实例图](./images/K230_DEMO_BOARD_USAGE_GUIDE/image8.png)
![Flash扩展-J9的原理图](./images/K230_DEMO_BOARD_USAGE_GUIDE/image9.png)
（**图2.2.1**：上图为flash模组子卡的实例图，左上白点处为引脚1，下图为Flash扩展-J9的原理图）

DEMO板的FLASH的扩展处已焊好验证后的flash模组，无需进一步的改动。选型为NOR
OSPI（GD25LX256E，厂商：Giga Device，256Mbits）

### 电源区（开机上电方式）

![主要器件位置](./images/K230_DEMO_BOARD_USAGE_GUIDE/image10.png)

（**图2.3.1**：电源区域主要器件位置，图示为通过开关上电的模式）

这个区域产生DEMO BOARD上所需的所有电源。全部与DEMO BOARD电源控制相关的交互器件皆位于此区域，并有2种上电开机模式可以选择（后续会说明选择方法）。**图2.3.1**中编号对应如下6个主要接口/器件（名称与**图2.1.1**中右图的列表一致）：

1. **启动方式选择开关（DEMO BOARD上器件编号：SW1）**
K230支持从四种不同的地方加载启动文件，通过四种高低电平状态来选择K230启动位置的拨码开关。四种状态分别对应的启动位置与SW1的原理图请参考下方**图2.3.2**。
![W1原理图](./images/K230_DEMO_BOARD_USAGE_GUIDE/image11.png)
（**图2.3.2**：SW1原理图）
其中，开关1，2分别对应BOOT0，BOOT1。将开关拨至引脚1，2对应高电平逻辑1（DEMO BOARD上标注的H侧），拨至引脚3，4对应低电平逻辑0（DEMO BOARD上标注的L侧）。以上编号均在DEMO BOARD板面上通过丝印注明。

1. **系统复位按键（DEMO BOARD上器件编号：K2）**
低有效按键复位。按下时拉低复位，松开时常态为高电平。可通过检测引脚2的电压判断当前的复位状况。

1. **开关机拨动开关（DEMO BOARD上器件编号：K3）**

1. **中断信号按键（DEMO BOARD上器件编号：K1）**
用于手动产生中断信号的测试用按键。

1. **电源入口 DC 5V：2A（DEMO BOARD上器件编号：J2）**

1. **PMU扩展（DEMO BOARD上器件编号：J1）**
电源测试时所用的排针扩展，在使用DEMO板时不需要。
![PMU扩展J1原理图](./images/K230_DEMO_BOARD_USAGE_GUIDE/image12.png)
（**图2.3.3**：PMU扩展J1原理图）

1. **红色LED电源指示灯（DEMO BOARD上器件编号：LED1）**

**正常开机流程如下：**

- 将SW1拨至所需的BOOT位置

- 将5V电压通过Type-C电源线接入电源入口-J2。

- 拨动K3至ON位置开机。若电源成功接通，则**图2.3.1**中的红色LED指示灯会亮起

- 在电源正常的情况下，可以通过查看复位状态是否为高平以确保K230成功启动。

- 若开机时电源指示灯不亮，请确认PMU扩展（J6）的15，16引脚处（即**图2.3.1**标号为6的方框中额外标示出的位置）的跳线帽是否被正确的插接。

### 视频输入输出（摄像头子板与屏幕子板）

![视频区域主要器件位置](./images/K230_DEMO_BOARD_USAGE_GUIDE/image13.png)
(**图2.4.1**：视频区域主要器件位置)

随DEMO BOARD一起交付的摄像头与屏幕子卡的连接处。**图2.4.1**中编号对应如下2个主要接口/器件（名称与**图2.1.1**中右图的列表一致）。

1. **显示屏扩展（DEMO BOARD上器件编号：J4）**
MIPI DSI的接口，是通过FPC连接线传输从MIPI发往（transmit to）显示屏的视频信号，亦称作MIPI TX接口。此处为**章节1.3**所述清单中的**DSI触摸屏幕转接板**的连接处，直接通过30Pin宽的FPC连接线接通J4与转接板即可。J4的引脚定义原理图如**图2.4.2**所示。
![显示屏扩展引脚定义原理图](./images/K230_DEMO_BOARD_USAGE_GUIDE/image14.png)
（**图2.4.2：**显示屏扩展引脚定义原理图，图中引脚31，32为固定引脚不是信号引脚，可忽略）

1. **Sensor扩展（DEMO BOARD上器件编号：J3）**
 MIPI CSI的接口，是通过板对板连接器传输MIPI从摄像头处收到（receive from）的视频信号，亦称作MIPI RX接口。此处为**章节1.3**所述清单中的**IMX335模组Sensor板**的连接处。**J3**的引脚定义原理图如**图2.4.3**所示。

![ Sensor扩展引脚定义原理图](./images/K230_DEMO_BOARD_USAGE_GUIDE/image15.png)
（**图2.4.3**： Sensor扩展引脚定义原理图）

在交付时全部模组子板已组装完毕，如**图1.3.1**所示。

### 音频输入输出

![耳机与麦克风](./images/K230_DEMO_BOARD_USAGE_GUIDE/image17.png)

（**图2.5.1**：耳机与麦克风在DEMO BOARD上的位置）

外接音频设备的区域，在此区域内的声音信号处理已全部在K230中完成，可直接接入耳机输出模拟信号，不需要进行改动。这个区块仅有模拟信号可用，另有数字声音信号从排针引出，通过I2S/PDM接口数字音频转接板在外部进行数模转化，这部分将在**章节2.7**中另行介绍。**图2.5.1**中编号对应如下2个主要接口/器件（名称与**图2.1.1**中右图的列表一致）：

1. **耳机（DEMO BOARD上器件编号：J7）**

1. **麦克风（DEMO BOARD上器件编号：U29）**

### 通用接口（常规开发方法）

![数据接口](./images/K230_DEMO_BOARD_USAGE_GUIDE/image18.png)
（**图2.6.1**：数据接口在DEMO BOARD上的位置）

与外部计算机/信息源的连接口集中处。**图2.6.1**中编号对应如下3个主要接口/器件（名称与**图2.1.1**中右图的列表一致）：

1. **USB 2.0（DEMO BOARD上器件编号：J11，J13）**
共计两路支持OTG的USB 2.0接口，直接与K230交互。J11对应USB0，J13对应USB1。

1. **TF卡槽/WIFI扩展（DEMO BOARD上器件编号：U4）**
K230支持从TF卡槽启动，此处是装载K230启动程序TF卡的位置。选择从TF卡启动的方式在**章节2.3**中已描述。此外，该卡槽可另接**章节1.3**清单中所述**WIFI子卡**，二者为复用关系。**WIFI子卡**用于为板面添加WIFI模块验证联网功能。该子卡具有TF卡槽金手指，直接嵌入TF卡槽即可正常使用。

1. **串口调试（DEMO BOARD上器件编号：J6）**
使用Type C数据线进行UART串口调试，串口速率默认为115200。

### 排针接口

![排针](./images/K230_DEMO_BOARD_USAGE_GUIDE/image19.png)
（**图2.7.1**：排针在DEMO BOARD上的位置，各排针的引脚1已圈出）

板面上的电源以及部分来自K230 GPIO的信号通过这里的排针接出。**图2.7.1**中编号对应如下3个主要接口/器件（名称与**图2.1.1**中右图的列表一致）：

1. **电源监测扩展（DEMO BOARD上器件编号：J10）**
系研发时内部的测试用接口，在使用K230做产品开发时不需要使用。

1. **SDIO/I2S/PDM/IOMUX扩展（DEMO BOARD上器件编号：J8）**
接往K230上GPIO26-37的排针，对应的IO电平电压为1.8V。前文**章节2.5**中有提到，**章节1.3**所述的子卡清单中的**I2S/PDM接口数字音频转接板**应被放置于此处，用于将K230产生的数字音频从外部进行数模转换。将子板的排母与此处的排针引脚1对齐扣上即可使用。引脚定义详见其原理图。
![SDIO/I2S/PDM/IOMUX扩展](./images/K230_DEMO_BOARD_USAGE_GUIDE/image21.png)
（**图2.7.2**：SDIO/I2S/PDM/IOMUX扩展-J8的原理图）

1. **JTAG扩展（DEMO BOARD上器件编号：J12）**
连接JTAG调试器的端口。使用时用杜邦线将JTAG扩展上的引脚与相应的JTAG调试器端口相连。其引脚定义见**图2.7.4。**
![JTAG扩展](./images/K230_DEMO_BOARD_USAGE_GUIDE/image22.png)
(**图2.7.3**：JTAG扩展的引脚定义原理图，数据线通过10K电阻上拉至1.8V)

1. **IOMUX/电源扩展（DEMO BOARD上器件编号：J5）**
USB与串口的控制排针，通过短接J5部分引脚的方可以改变**章节2.6**提到的两个USB接口的模式。J5的引脚定义见**图2.7.5。**
若需要USB0作为HOST使用，或者用于转以太网口时，则需使用跳线帽短接J5的引脚1，2，作为DEVICE时则保持引脚1，2开路。(交付时默认已短接)
相应的，USB1作为HOST使用，或者用于转以太网口时，在J5的引脚3，4上添加跳帽。（交付时默认未短接）
此外，引脚8，10可分别以UART_RX和UART_TX作为额外的一路调试串口使用**。**
![IOMUX/电源扩展](./images/K230_DEMO_BOARD_USAGE_GUIDE/image23.png)
（**图2.7.4**：IOMUX/电源扩展-J5的原理图）

1. **ADC扩展（DEMO BOARD上器件编号：J15）**
K230有共计6个ADC输入口引出至J15处可以根据使用需求，收集传感器数据或者反馈信号。ADC的输入位置位于MIPI CSI接口旁边。其中ADC5（**图2.7.1**最右侧下数第二孔）与耳机复用，在未接入耳机时，该ADC输入将始终接地无法正常使用，请注意。若ADC５无读数，将耳机接入耳机孔即可。
